!function(exports,global){global["true"]=exports,define("ember-insights",["runtime","middleware","exports"],function(__dependency1__,__dependency2__,__exports__){"use strict";var runtime=__dependency1__["default"],middleware=__dependency2__["default"],initializer=function(){var Addon={isActivated:!1,configs:{},settings:null};return middleware.use(Addon),runtime(Addon)}();__exports__["default"]=initializer}),define("handler",["exports"],function(__exports__){"use strict";function transitionHandler(data,tracker,settings){switch(settings.trackTransitionsAs){case"event":tracker.sendEvent("transition",JSON.stringify({from:data.oldRouteName,to:data.routeName}));break;case"pageview":tracker.trackPageView(data.url)}}function actionHandler(data,tracker,settings){settings=settings||{};var actionLabel=data.actionArguments[0],actionValue=data.actionArguments[1];tracker.sendEvent("action",data.actionName,actionLabel,actionValue)}__exports__["default"]={factory:function(settings){function defaultDispatcher(type,data,tracker){switch(type){case"transition":transitionHandler(data,tracker,settings);break;case"action":actionHandler(data,tracker,settings)}}return defaultDispatcher},transitionHandler:transitionHandler,actionHandler:actionHandler}}),define("matcher",["exports"],function(__exports__){"use strict";function groupMatches(group,routeName,eventType,eventValueToMatch){var routeNameNoIndex=routeName.replace(".index",""),allKey="ALL_"+eventType.toUpperCase()+"S",all=group.insights.getWithDefault(allKey,!1);if(checkInAll(all,eventType,eventValueToMatch,routeNameNoIndex))return allKey;for(var toMatch=getSearchingPaths(eventType,routeName,routeNameNoIndex,eventValueToMatch),i=0,len=toMatch.length;len>i;i++){var path=toMatch[i][0],entity=toMatch[i][1];if(group.insights.getWithDefault(path,[]).indexOf(entity)>-1)return path}return!1}function getSearchingPaths(eventType,routeName,routeNameNoIndex,eventValueToMatch){return"transition"===eventType?[["TRANSITIONS",routeName],["TRANSITIONS",routeNameNoIndex],["MAP."+routeName+".ACTIONS","TRANSITION"],["MAP."+routeNameNoIndex+".ACTIONS","TRANSITION"]]:"action"===eventType?[["ACTIONS",eventValueToMatch],["MAP."+routeName+".ACTIONS",eventValueToMatch],["MAP."+routeNameNoIndex+".ACTIONS",eventValueToMatch]]:void 0}function getMatchedGroups(groups,routeName,eventType,eventValueToMatch){for(var result=[],i=0,len=groups.length;len>i;i++){var group=groups[i],keys=groupMatches(group,routeName,eventType,eventValueToMatch);pushToResult(keys,group,result)}return result}function pushToResult(keyMatched,group,holder){keyMatched&&holder.push({group:group,keyMatched:keyMatched})}function checkInAll(matchAllConfig,eventType,eventValueToMatch,routeNameNoIndex){if(matchAllConfig===!0)return!0;if("object"==typeof matchAllConfig&&matchAllConfig.except){var listOfExcepted=matchAllConfig.except,valuesToMatch=[eventValueToMatch];if("transition"===eventType&&routeNameNoIndex!==eventValueToMatch&&valuesToMatch.push(routeNameNoIndex),0===Ember.EnumerableUtils.intersection(valuesToMatch,listOfExcepted).length)return!0}return!1}function processMatchedGroups(matchedGroups,addonSettings,eventType,eventParams){for(var i=0,len=matchedGroups.length;len>i;i++){var matchedGroup=matchedGroups[i].group;"transition"===eventType&&addonSettings.updateDocumentLocationOnTransitions&&matchedGroup.tracker.set("location",document.URL),matchedGroup.dispatch(eventType,eventParams,matchedGroup.tracker)}}__exports__.getMatchedGroups=getMatchedGroups,__exports__.processMatchedGroups=processMatchedGroups,__exports__.pushToResult=pushToResult,__exports__.getSearchingPaths=getSearchingPaths,__exports__.checkInAll=checkInAll}),define("middleware",["matcher","exports"],function(__dependency1__,__exports__){"use strict";var getMatchedGroups=__dependency1__.getMatchedGroups,processMatchedGroups=__dependency1__.processMatchedGroups;__exports__["default"]={use:function(addon){function _handle(type,data){var eventName,valueToMatch;switch(type){case"transition":eventName=type,valueToMatch=data.routeName;break;case"action":eventName=data.actionName,valueToMatch=data.actionName}var matchedGroups=getMatchedGroups(addon.settings.mappings,data.routeName,type,valueToMatch);if(addon.settings.debug){var isMapped=matchedGroups.length?" SEND":" TRAP",msg="Ember-Insights%@: '%@'".fmt(isMapped,eventName);data.oldRouteName&&(msg+=" from '%@':'%@'".fmt(data.oldRouteName,data.oldUrl));var prep="action"===type?"action from":"to";data.routeName&&(msg+=" %@ '%@':'%@'".fmt(prep,data.routeName,data.url)),Ember.debug(msg)}processMatchedGroups(matchedGroups,addon.settings,type,data)}function actionMiddleware(actionName){if(!addon.isActivated)return void this._super.apply(this,arguments);var appController=this.container.lookup("controller:application"),routeName=appController.get("currentRouteName");_handle("action",{actionName:actionName,actionArguments:[].slice.call(arguments,1),route:this.container.lookup("route:"+routeName),routeName:this.container.lookup("controller:application").get("currentRouteName"),url:this.container.lookup("router:main").get("url")}),this._super.apply(this,arguments)}function transitionMiddleware(){if(!addon.isActivated)return void this._super.apply(this,arguments);var appController=this.container.lookup("controller:application"),oldRouteName=appController.get("currentRouteName"),oldUrl=oldRouteName?this.get("url"):"";this._super.apply(this,arguments);var newRouteName=appController.get("currentRouteName");Ember.run.scheduleOnce("routerTransitions",this,function(){var newUrl=this.get("url")||"/";_handle("transition",{route:this.container.lookup("route:"+newRouteName),routeName:newRouteName,oldRouteName:oldRouteName,url:newUrl,oldUrl:oldUrl})})}Ember.ActionHandler.reopen({send:actionMiddleware}),Ember.Router.reopen({didTransition:transitionMiddleware})}}}),define("optparse",["trackers/console","handler","exports"],function(__dependency1__,__dependency2__,__exports__){"use strict";var DefaultTracker=__dependency1__["default"],DefaultHandler=__dependency2__["default"];__exports__["default"]={trackerOpts:function(opts){return this.mergeTrackerOpts(opts,opts)},mergeTrackerOpts:function(opts,basicOpts){var assert;return opts.debug=void 0===opts.debug?!0:opts.debug,opts.trackerFactory=opts.trackerFactory||basicOpts.trackerFactory||DefaultTracker.factory,assert="function"==typeof opts.trackerFactory,Ember.assert("'trackerFactory' should be a function",assert),opts.tracker=opts.trackerFactory(opts),assert="object"==typeof opts.tracker,Ember.assert("Can't build tracker",assert),opts.trackTransitionsAs=opts.trackTransitionsAs||basicOpts.trackTransitionsAs||"pageview",opts},basicOpts:function(opts){return"undefined"==typeof opts.updateDocumentLocationOnTransitions&&(opts.updateDocumentLocationOnTransitions=!0),opts},dispatcherOpts:function(opts){opts.dispatch=opts.dispatch||DefaultHandler.factory(opts);var assert="function"==typeof opts.dispatch;return Ember.assert("'dispatch' should be a function",assert),opts}}}),define("runtime",["optparse","trackers","exports"],function(__dependency1__,__dependency2__,__exports__){"use strict";var optparse=__dependency1__["default"],ConsoleTracker=__dependency2__.ConsoleTracker,GoogleTracker=__dependency2__.GoogleTracker;__exports__["default"]=function(addon){var _settings,runtime={configure:function(env,settings){return env=env||"default",settings=settings||{},_settings=settings,optparse.basicOpts(settings),optparse.trackerOpts(settings),settings.mappings=[],addon.configs[env]=settings,this},track:function(mapping){return Ember.assert("Can't find `insights` property inside",mapping.insights),mapping.insights=Ember.Object.create(mapping.insights),optparse.mergeTrackerOpts(mapping,_settings),optparse.dispatcherOpts(mapping),_settings.mappings.push(mapping),this},start:function(env){return addon.settings=addon.configs[env],Ember.assert("can't find settings for '"+env+"' environment",addon.settings),addon.isActivated=!0,addon.settings.tracker},stop:function(){addon.isActivated=!1},ConsoleTracker:ConsoleTracker,GoogleTracker:GoogleTracker};return runtime}}),define("trackers",["trackers/console","trackers/google","exports"],function(__dependency1__,__dependency2__,__exports__){"use strict";var ConsoleTracker=__dependency1__["default"],GoogleTracker=__dependency2__["default"];__exports__.ConsoleTracker=ConsoleTracker,__exports__.GoogleTracker=GoogleTracker}),define("trackers/abstract-tracker",["../vendor/inheritance","exports"],function(__dependency1__,__exports__){"use strict";function notYetImplemented(signature){Ember.warn("function '"+signature+"' is not yet implemented")}var Class=__dependency1__["default"],AbstractTracker=Class.extend({isTracker:function(){notYetImplemented("isTracker()")},getTracker:function(){notYetImplemented("getTracker()")},set:function(){notYetImplemented("set(key, value)")},send:function(){notYetImplemented("send(fields)")},sendEvent:function(){notYetImplemented("sendEvent(category, action, label, value)")},trackPageView:function(){notYetImplemented("trackPageView(path, fields)")}});__exports__["default"]=AbstractTracker}),define("trackers/console",["trackers/abstract-tracker","exports"],function(__dependency1__,__exports__){"use strict";function logger(label,params){var message="LOG: Ember-Insights: ConsoleTracker.%@(%@)".fmt(label,params);Ember.Logger.log(message)}var AbstractTracker=__dependency1__["default"];__exports__["default"]={factory:function(){var Tracker=AbstractTracker.extend({getTracker:function(){return logger},set:function(key,value){logger("set",[key,value])},send:function(fieldNameObj){logger("send",[fieldNameObj])},sendEvent:function(category,action,label,value){logger("sendEvent",[category,action,label,value])},trackPageView:function(path,fieldNameObj){logger("trackPageView",["pageview",path,fieldNameObj])}});return new Tracker}}}),define("trackers/google",["trackers/abstract-tracker","exports"],function(__dependency1__,__exports__){"use strict";function trackerFun(trackerFun,global){return global=global||window,"string"==typeof trackerFun&&(trackerFun=global[trackerFun]),trackerFun}function trackingNamespace(name){return function(action){return(name?name+".":"")+action}}function setFields(tracker,namespace,fields){for(var propName in fields)tracker(namespace("set"),propName,fields[propName])}function _buildFactory(trackerOptions){return trackerOptions=trackerOptions||{},function(){function tracker(){return trackerFun(trackerOptions.trackerFun||"ga")}var namespace=trackingNamespace(trackerOptions.name||""),Tracker=AbstractTracker.extend({init:function(){trackerOptions.fields&&setFields(tracker(),namespace,trackerOptions.fields)},isTracker:function(){return tracker()&&"function"==typeof tracker()},getTracker:function(){return tracker()},set:function(key,value){tracker()(namespace("set"),key,value)},send:function(fields){fields=fields||{},tracker()(namespace("send"),fields)},sendEvent:function(category,action,label,value){var fields={hitType:"event",eventCategory:category,eventAction:action,eventLabel:label,eventValue:value};this.send(fields)},trackPageView:function(path,fields){if(fields=fields||{},!path){var loc=window.location;path=loc.hash?loc.hash.substring(1):loc.pathname+loc.search}tracker()(namespace("send"),"pageview",path,fields)}});return new Tracker}}var AbstractTracker=__dependency1__["default"];__exports__["default"]={factory:_buildFactory(),"with":function(trackerOptions){return _buildFactory(trackerOptions)},trackerFun:trackerFun,trackingNamespace:trackingNamespace,setFields:setFields}}),define("vendor/inheritance",["exports"],function(__exports__){"use strict";var MainClass=function(){var initializing=!1,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,MainClass=function(){};return MainClass.extend=function extendFunction(prop){function Class(){!initializing&&this.init&&this.init.apply(this,arguments)}var _super=this.prototype;initializing=!0;var prototype=new this;initializing=!1;for(var name in prop)prototype[name]="function"==typeof prop[name]&&"function"==typeof _super[name]&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,prop[name]):prop[name];return Class.prototype=prototype,Class.prototype.constructor=Class,Class.extend=extendFunction,Class},MainClass}();__exports__["default"]=MainClass})}({},function(){return this}());
//# sourceMappingURL=ember-insights.amd.min.js.map